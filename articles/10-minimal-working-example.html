<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting Started: A Minimal Working Example ‚Ä¢ eam</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Getting Started: A Minimal Working Example">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">eam</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/00-framework-overview.html">Overview of the EAM Framework</a></li>
    <li><a class="dropdown-item" href="../articles/10-minimal-working-example.html">Getting Started: A Minimal Working Example</a></li>
    <li><a class="dropdown-item" href="../articles/20-models-in-eam.html">Models in eam</a></li>
    <li><a class="dropdown-item" href="../articles/30-empirical-example.html">An Empirical Example: Simulation-Based Inference for Free Recall</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Developer Guide</h6></li>
    <li><a class="dropdown-item" href="../articles/developer-guide.html">Developer Guide</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Chinese Translation</h6></li>
    <li><a class="dropdown-item" href="../articles/about-zh-translation.html">About Chinese Translation</a></li>
    <li><a class="dropdown-item" href="../articles/developer-guide.zh.html">ÂºÄÂèë‰∫∫ÂëòÂºïÂØº</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/y-guang/eam/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Getting Started: A Minimal Working Example</h1>
                        <h4 data-toc-skip class="author">Guangyu
Zhu</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/y-guang/eam/blob/main/vignettes/10-minimal-working-example.Rmd" class="external-link"><code>vignettes/10-minimal-working-example.Rmd</code></a></small>
      <div class="d-none name"><code>10-minimal-working-example.Rmd</code></div>
    </div>

    
    
<p>This section aims to help you grasp the basic workflow to run this
package. In this section, we will outline the main functionality of the
package and demonstrating a minimal working example that can be run with
minimal knowledge about EAMs.</p>
<p>The workflow implemented in <strong>eam</strong> follows the standard
workflow in simulation-based inference. First, we begin by specifying a
data-generating process, simulate data under a range of parameter
values, and then use simulation-based inference to learn which
parameters are most consistent with the observed data.</p>
<p>Concretely, the workflow consists of four steps:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Model specification and simulation</strong>: Define an
evidence accumulation model by specifying its structural components
(boundaries, drift, noise, and non-decision processes), and simulate
synthetic datasets from the prior.</li>
<li>
<strong>Summary statistics computation</strong>: Reduce both
simulated and observed data to informative summary statistics that
capture key data patterns.</li>
<li>
<strong>Parameter estimation and recovery</strong>: Use ABC (or ABI)
to infer posterior distributions over parameters, and evaluate whether
the inference procedure can reliably recover known parameters.</li>
<li>
<strong>Model evaluation and comparison</strong>: Assess model
adequacy using posterior predictive checks, and compare alternative
model specifications.</li>
</ol>
<p>The following sections walk through these steps in detail using a
simple DDM example, before extending the workflow to more complex
models.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load necessary packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://y-guang.github.io/eam">eam</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set a random seed for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>In this example, we start with a simple three-parameter two-boundary
Diffusion Decision Model (DDM).</p>
<p>Although the DDM has a trackable likelihood, we deliberately treat it
as a generative model here. This allows us to demonstrate the full
simulation-based workflow in a setting where the ground truth is
known.</p>
<p>Here, we adopt a slightly different parameterization from the
conventional DDM: instead of assuming accumulation from a positive
starting point toward 0 or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>,
evidence is initialized at zero and evolves toward symmetric bounds at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>‚àí</mo><mi>a</mi></mrow><annotation encoding="application/x-tex">-a</annotation></semantics></math>.</p>
<p>The details of this model is listed below:</p>
<p><strong>Priors on global parameters</strong>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>A</mi><mn>0</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>‚àº</mo><mtext mathvariant="normal">Uniform</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>5</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>V</mi><mn>0</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>‚àº</mo><mtext mathvariant="normal">Uniform</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>0.5</mn><mo>,</mo><mn>3</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>n</mi><mi>d</mi><msub><mi>t</mi><mn>0</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>‚àº</mo><mtext mathvariant="normal">Uniform</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>œÅ</mi><mn>0</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mn>0.5</mn><mi>.</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
A_0 &amp;\sim \text{Uniform}(1, 5), \\
V_0 &amp;\sim \text{Uniform}(0.5, 3), \\
ndt_0 &amp;\sim \text{Uniform}(0, 1), \\
\rho_0 &amp;= 0.5 .
\end{aligned}
</annotation></semantics></math></p>
<p><strong>Item-level parameterization</strong>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>œÅ</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>œÅ</mi><mn>0</mn></msub><mo>,</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>A</mi><mtext mathvariant="normal">upper</mtext></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>œÅ</mi><msub><mi>A</mi><mn>0</mn></msub><mo>,</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>A</mi><mtext mathvariant="normal">lower</mtext></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>‚àí</mo><mi>œÅ</mi><msub><mi>A</mi><mn>0</mn></msub><mo>,</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>V</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>V</mi><mn>0</mn></msub><mo>,</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>n</mi><mi>d</mi><mi>t</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>n</mi><mi>d</mi><msub><mi>t</mi><mn>0</mn></msub><mi>.</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
\rho &amp;= \rho_0, \\
A_{\text{upper}} &amp;= \rho A_0, \\
A_{\text{lower}} &amp;= -\rho A_0, \\
V &amp;= V_0, \\
ndt &amp;= ndt_0 .
\end{aligned}
</annotation></semantics></math></p>
<p><strong>Evidence accumulation dynamics</strong>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>X</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>V</mi><mspace width="0.167em"></mspace><mi>d</mi><mi>t</mi><mo>+</mo><mi>d</mi><mi>W</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="2.0em"></mspace><mi>d</mi><mi>W</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àº</mo><mi>ùí©</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mi>d</mi><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
dX(t) = V \, dt + dW(t), \qquad dW(t) \sim \mathcal{N}(0, dt).
</annotation></semantics></math></p>
<p>A decision is made when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">X(t)</annotation></semantics></math>
first reaches either
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mtext mathvariant="normal">upper</mtext></msub><annotation encoding="application/x-tex">A_{\text{upper}}</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mtext mathvariant="normal">lower</mtext></msub><annotation encoding="application/x-tex">A_{\text{lower}}</annotation></semantics></math>,
and the observed response time is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>T</mi><mo>=</mo><msub><mi>T</mi><mtext mathvariant="normal">decision</mtext></msub><mo>+</mo><mi>n</mi><mi>d</mi><mi>t</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">
RT = T_{\text{decision}} + ndt .
</annotation></semantics></math></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#######################</span></span>
<span><span class="co"># Model specification #</span></span>
<span><span class="co">#######################</span></span>
<span><span class="co"># Define the number of accumulators</span></span>
<span><span class="va">n_items</span> <span class="op">&lt;-</span><span class="fl">1</span></span>
<span></span>
<span><span class="co"># Set the number of accumulators in the model</span></span>
<span><span class="va">prior_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  n_items <span class="op">=</span> <span class="va">n_items</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Specify the prior distributions for free parameters</span></span>
<span><span class="va">prior_formulas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="co"># Decision boundary</span></span>
<span>  <span class="va">A_0</span> <span class="op">~</span> <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_uniform.html" class="external-link">dist_uniform</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  <span class="co"># Drift rate</span></span>
<span>  <span class="va">V_0</span> <span class="op">~</span> <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_uniform.html" class="external-link">dist_uniform</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  <span class="co"># Non-decision time</span></span>
<span>  <span class="va">ndt_0</span> <span class="op">~</span> <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_uniform.html" class="external-link">dist_uniform</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="co"># Relative starting point</span></span>
<span>  <span class="va">rho_0</span> <span class="op">~</span> <span class="fl">0.5</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Specify the between-trial components (skipped here)</span></span>
<span><span class="va">between_trial_formulas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Specify the item-level parameters</span></span>
<span><span class="va">item_formulas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="co"># Relative starting point</span></span>
<span>  <span class="va">rho</span> <span class="op">~</span> <span class="va">rho_0</span>,</span>
<span>  <span class="co"># Decision boundary</span></span>
<span>  <span class="va">A_upper</span> <span class="op">~</span> <span class="va">rho</span><span class="op">*</span><span class="op">(</span><span class="va">A_0</span><span class="op">)</span>, <span class="co"># upper </span></span>
<span>  <span class="va">A_lower</span> <span class="op">~</span> <span class="op">-</span><span class="va">rho</span><span class="op">*</span><span class="op">(</span><span class="va">A_0</span><span class="op">)</span>, <span class="co"># lower</span></span>
<span>  <span class="co"># Drift rate</span></span>
<span>  <span class="va">V</span> <span class="op">~</span> <span class="va">V_0</span>,</span>
<span>  <span class="co"># Non-decision time</span></span>
<span>  <span class="va">ndt</span> <span class="op">~</span> <span class="va">ndt_0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Specify the diffusion noise</span></span>
<span><span class="va">noise_factory</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">context</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">dt</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">dt</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Once the model is specified, we can proceed to data simulation. The
simulation step generates a large collection of synthetic datasets by
sampling parameters from their prior distributions and simulating data
from the corresponding generative model. Each simulated dataset
represents a possible outcome implied by the assumed model.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">####################</span></span>
<span><span class="co"># Simulation setup #</span></span>
<span><span class="co">####################</span></span>
<span><span class="va">sim_config</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/new_simulation_config.html">new_simulation_config</a></span><span class="op">(</span></span>
<span>  <span class="co"># Pass the model information</span></span>
<span>  prior_formulas <span class="op">=</span> <span class="va">prior_formulas</span>,</span>
<span>  between_trial_formulas <span class="op">=</span> <span class="va">between_trial_formulas</span>,</span>
<span>  item_formulas <span class="op">=</span> <span class="va">item_formulas</span>,</span>
<span>  <span class="co"># Specify the simulation conditions and number of trials</span></span>
<span>  n_conditions_per_chunk <span class="op">=</span> <span class="cn">NULL</span>, <span class="co"># NULL = automatic chunking</span></span>
<span>  n_conditions <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  n_trials_per_condition <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  <span class="co"># Specify the number of accumulators and the number of recorded accumulators</span></span>
<span>  n_items <span class="op">=</span> <span class="va">n_items</span>,</span>
<span>  max_reached <span class="op">=</span> <span class="va">n_items</span>,</span>
<span>  <span class="co"># Specify the total elapsed time and time step</span></span>
<span>  max_t <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  dt <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  <span class="co"># Specify the noise structure</span></span>
<span>  noise_mechanism <span class="op">=</span> <span class="st">"add"</span>,</span>
<span>  noise_factory <span class="op">=</span> <span class="va">noise_factory</span>,</span>
<span>  <span class="co"># Specify the model type</span></span>
<span>  model <span class="op">=</span> <span class="st">"ddm-2b"</span>,</span>
<span>  <span class="co"># Specify the parallel computing settings</span></span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># In tutorial, we disable parallelization, but you are encouraged to enable it locally</span></span>
<span>  n_cores <span class="op">=</span> <span class="cn">NULL</span>, <span class="co"># When parallel enabled, will use default: detectCores() - 1</span></span>
<span>  rand_seed <span class="op">=</span> <span class="cn">NULL</span> <span class="co"># Will use default random seed</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Output temporary path setup</span></span>
<span><span class="va">temp_output_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="st">"eam_demo_output"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">##################</span></span>
<span><span class="co"># Run simulation #</span></span>
<span><span class="co">##################</span></span>
<span><span class="va">sim_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_simulation.html">run_simulation</a></span><span class="op">(</span></span>
<span>  config <span class="op">=</span> <span class="va">sim_config</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="va">temp_output_path</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>For observed data, we create a small dataset using the
<strong>rtdists</strong> package, which provides fast simulators for
standard DDM. Specifically, we simulate N=500 trials from a two-boundary
DDM with fixed parameters
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>,<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>v</mi><annotation encoding="application/x-tex">v</annotation></semantics></math>,<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mn>0</mn></mrow><annotation encoding="application/x-tex">t0</annotation></semantics></math>)
where a controls boundary separation,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>v</mi><annotation encoding="application/x-tex">v</annotation></semantics></math>
is the drift rate, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mn>0</mn></mrow><annotation encoding="application/x-tex">t0</annotation></semantics></math>
captures non-decision time.</p>
<p>The function <em>rdiffusion()</em> returns response labels
(‚Äúupper‚Äù/‚Äúlower‚Äù) and response times. For consistency with the data
format produced by our simulation engine, we recode responses into a
numeric choice variable (1 for the upper boundary and -1 for the lower
boundary), and we add a condition_idx field to indicate that all trials
belong to a single experimental condition</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">############################</span></span>
<span><span class="co"># Observed data generation #</span></span>
<span><span class="co">############################</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rtdists/rtdists/" class="external-link">rtdists</a></span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span></span>
<span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  a  <span class="op">=</span> <span class="fl">2.0</span>,   <span class="co"># Decision boundary</span></span>
<span>  v  <span class="op">=</span> <span class="fl">2.0</span>,   <span class="co"># Drift rate</span></span>
<span>  t0 <span class="op">=</span> <span class="fl">0.5</span>  <span class="co"># Non-decision time</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># rdiffusion() will return responses and RTs from a standard DDM </span></span>
<span><span class="va">observed_data</span> <span class="op">&lt;-</span> <span class="fu">rdiffusion</span><span class="op">(</span>n <span class="op">=</span> <span class="va">N</span>, a <span class="op">=</span> <span class="va">pars</span><span class="op">$</span><span class="va">a</span>, v <span class="op">=</span> <span class="va">pars</span><span class="op">$</span><span class="va">v</span>, t0 <span class="op">=</span> <span class="va">pars</span><span class="op">$</span><span class="va">t0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Recode the data to be consistent with simulated data</span></span>
<span><span class="va">observed_data</span><span class="op">$</span><span class="va">choice</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">observed_data</span> <span class="op">$</span><span class="va">response</span> <span class="op">==</span> <span class="st">"upper"</span>, <span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">observed_data</span><span class="op">$</span><span class="va">condition_idx</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></code></pre></div>
<p>we define a summary pipeline that extracts two types of common
summary statistics of the DDM data: (i) the accuracy and (ii) RT
quantiles (10%, 30%, 50%, 70%, 90%) computed separately for each choice
category (1 vs.¬†-1).</p>
<p>We then apply the same summary procedure to every simulated dataset
to obtain <em>simulation_sumstat</em>, and to the observed dataset to
obtain <em>target_sumstat</em>. Finally, build_abc_input() aligns the
simulated and observed summaries into a consistent structure.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#####################</span></span>
<span><span class="co"># abc model prepare #</span></span>
<span><span class="co">#####################</span></span>
<span></span>
<span><span class="co"># Define the summary procedure</span></span>
<span><span class="va">summary_pipe</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/summarise_by.html">summarise_by</a></span><span class="op">(</span></span>
<span>    .by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"condition_idx"</span><span class="op">)</span>,</span>
<span>    acc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">choice</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">choice</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/summarise_by.html">summarise_by</a></span><span class="op">(</span></span>
<span>    .by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"condition_idx"</span>, <span class="st">"choice"</span><span class="op">)</span>,</span>
<span>    rt_quantiles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">rt</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate simulated summary statistics</span></span>
<span><span class="va">simulation_sumstat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map_by_condition.html">map_by_condition</a></span><span class="op">(</span></span>
<span>  <span class="va">sim_output</span>,</span>
<span>  .progress <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  .parallel <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># turn on if you want to speed up</span></span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">cond_df</span><span class="op">)</span> <span class="fu">summary_pipe</span><span class="op">(</span><span class="va">cond_df</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate observed summary statistics</span></span>
<span><span class="va">target_sumstat</span> <span class="op">&lt;-</span> <span class="fu">summary_pipe</span><span class="op">(</span><span class="va">observed_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Align the simulated and observed summary statistics</span></span>
<span><span class="va">abc_input</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_abc_input.html">build_abc_input</a></span><span class="op">(</span></span>
<span>  simulation_output <span class="op">=</span> <span class="va">sim_output</span>,</span>
<span>  simulation_summary <span class="op">=</span> <span class="va">simulation_sumstat</span>,</span>
<span>  target_summary     <span class="op">=</span> <span class="va">target_sumstat</span>,</span>
<span>  param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A_0"</span>,<span class="st">"V_0"</span>,<span class="st">"ndt_0"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>With the simulated and observed summary statistics aligned, we can
now estimate the posterior distribution of the model parameters using
Approximate Bayesian Computation (ABC).</p>
<p>Specifically, we fit an ABC model by comparing the simulated summary
statistics to the observed summary statistics. Then we retain (or
reweight) parameter draws that best reproduce the observed summaries
under a tolerance level (tol=0.05).</p>
<p>Here we use a neural-net-adjusted ABC variant (method = ‚Äúneuralnet‚Äù),
which learns a flexible mapping from summary statistics to parameters to
improve posterior approximation.</p>
<p>These diagnostics help verify whether the posterior concentrates on
plausible regions of the parameter space and whether the recovered
parameters are consistent with the parameters in the
<em>rdiffusion()</em> model.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">########################</span></span>
<span><span class="co"># Parameter estimation #</span></span>
<span><span class="co">########################</span></span>
<span></span>
<span><span class="co"># Fit abc model (neuralnet)</span></span>
<span><span class="va">abc_fit</span> <span class="op">&lt;-</span> <span class="fu">abc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/abc/man/abc.html" class="external-link">abc</a></span><span class="op">(</span></span>
<span>  target <span class="op">=</span> <span class="va">abc_input</span><span class="op">$</span><span class="va">target</span>,</span>
<span>  param  <span class="op">=</span> <span class="va">abc_input</span><span class="op">$</span><span class="va">param</span>,</span>
<span>  sumstat<span class="op">=</span> <span class="va">abc_input</span><span class="op">$</span><span class="va">sumstat</span>,</span>
<span>  tol    <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"neuralnet"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: All parameters are "none" transformed.</span></span>
<span><span class="co">#&gt; 12345678910</span></span>
<span><span class="co">#&gt; 12345678910</span></span></code></pre></div>
<p>After fitting, we summarize the posterior means/medians and 95%
credible intervals and visualize the resulting posterior
distributions.</p>
<p>As shown, the true parameter values underlying the observed data lie
well within the 95% credible intervals of the posterior
distributions.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Posterior estimation check</span></span>
<span><span class="fu"><a href="../reference/summarise_posterior_parameters.html">summarise_posterior_parameters</a></span><span class="op">(</span></span>
<span>  <span class="va">abc_fit</span>,</span>
<span>  ci_level <span class="op">=</span> <span class="fl">0.95</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   parameter      mean    median ci_lower_0.025 ci_upper_0.975</span></span>
<span><span class="co">#&gt; 1       A_0 1.8527969 1.8472045      1.6285389      2.1260080</span></span>
<span><span class="co">#&gt; 2       V_0 1.9133499 1.9342754      1.7349258      2.0046695</span></span>
<span><span class="co">#&gt; 3     ndt_0 0.4854268 0.4860683      0.4370122      0.5083276</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_posterior_parameters.html">plot_posterior_parameters</a></span><span class="op">(</span></span>
<span>  <span class="va">abc_fit</span>,</span>
<span>  <span class="va">abc_input</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="10-minimal-workflow/unnamed-chunk-8-1.svg" alt="plot of chunk unnamed-chunk-8"><div class="figcaption">plot of chunk unnamed-chunk-8</div>
</div>
<p>The next step is to evaluate parameter recovery for the model. To do
so, we run <em>cv4abc()</em> as a cross-validation procedure.</p>
<p>First, we specify the number of validation datasets (N=100). The
function then randomly samples N conditions from the simulated summary
statistics, treats their associated parameter values as known ground
truth, and re-estimates the parameters using the fitted ABC object under
the same tolerance level.</p>
<p>Recovery performance is visualized using <em>plot_cv_recovery()</em>,
which compares the estimated parameters with their true values across
validation datasets.</p>
<p>Good recovery is indicated by a high correlation between estimated
and true parameters (good:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>‚â•</mo><mn>0.75</mn></mrow><annotation encoding="application/x-tex">r \ge 0.75</annotation></semantics></math>;
excellent:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>‚â•</mo><mn>0.90</mn></mrow><annotation encoding="application/x-tex">r \ge 0.90</annotation></semantics></math>)
and by estimates clustering closely around the identity line with
minimal residual dispersion.</p>
<p>The resid_tol option trims extreme residuals (here retaining the
central 99%), making the main recovery pattern easier to inspect.</p>
<p>As shown, the three parameters exhibit excellent recovery.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Parameter recovery check</span></span>
<span><span class="fu"><a href="../reference/plot_cv_recovery.html">plot_cv_recovery</a></span><span class="op">(</span></span>
<span>  <span class="va">abc_cv</span>,</span>
<span>  n_rows <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  n_cols <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  resid_tol <span class="op">=</span> <span class="fl">0.99</span>,</span>
<span>  interactive <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="10-minimal-workflow/unnamed-chunk-9-1.svg" alt="plot of chunk unnamed-chunk-9"><div class="figcaption">plot of chunk unnamed-chunk-9</div>
</div>
<p>As a final diagnostic, we perform a posterior predictive check to
assess the adequacy of the fitted model.</p>
<p>Specifically, we generate the posterior data using posterior median
estimates obtained from the ABC analysis. The resulting posterior
predictive simulations are then compared with the observed dataset.</p>
<p>By visually inspecting the overlap between simulated and observed RT
distributions and accuracy rates, we can evaluate whether the fitted
model is able to reproduce key empirical patterns.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##############################</span></span>
<span><span class="co"># Posterior predictive check #</span></span>
<span><span class="co">##############################</span></span>
<span></span>
<span><span class="co"># Use posterior median as input</span></span>
<span><span class="va">prior_formulas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="co"># Decision boundary</span></span>
<span>  <span class="va">A_0</span> <span class="op">~</span> <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_uniform.html" class="external-link">dist_uniform</a></span><span class="op">(</span><span class="fl">1.96</span>, <span class="fl">1.96</span><span class="op">)</span>,</span>
<span>  <span class="co"># Drift rate</span></span>
<span>  <span class="va">V_0</span> <span class="op">~</span> <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_uniform.html" class="external-link">dist_uniform</a></span><span class="op">(</span><span class="fl">2.10</span>, <span class="fl">2.10</span><span class="op">)</span>,</span>
<span>  <span class="co"># Non-decision time</span></span>
<span>  <span class="va">ndt_0</span> <span class="op">~</span> <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_uniform.html" class="external-link">dist_uniform</a></span><span class="op">(</span><span class="fl">0.48</span>,<span class="fl">0.48</span><span class="op">)</span>,</span>
<span>  <span class="co"># Relative starting point</span></span>
<span>  <span class="va">rho_0</span> <span class="op">~</span> <span class="fl">0.5</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run the posteior simulation</span></span>
<span><span class="va">sim_config_post</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/new_simulation_config.html">new_simulation_config</a></span><span class="op">(</span></span>
<span>  prior_formulas <span class="op">=</span> <span class="va">prior_formulas</span>,</span>
<span>  between_trial_formulas <span class="op">=</span> <span class="va">between_trial_formulas</span>,</span>
<span>  item_formulas <span class="op">=</span> <span class="va">item_formulas</span>,</span>
<span>  n_conditions_per_chunk <span class="op">=</span> <span class="cn">NULL</span>, <span class="co"># automatic chunking</span></span>
<span>  n_conditions <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  n_trials_per_condition <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  n_items <span class="op">=</span> <span class="va">n_items</span>,</span>
<span>  max_reached <span class="op">=</span> <span class="va">n_items</span>,</span>
<span>  max_t <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  dt <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  noise_mechanism <span class="op">=</span> <span class="st">"add"</span>,</span>
<span>  noise_factory <span class="op">=</span> <span class="va">noise_factory</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"ddm-2b"</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="cn">NULL</span>, <span class="co"># Will use default: detectCores() - 1</span></span>
<span>  rand_seed <span class="op">=</span> <span class="cn">NULL</span> <span class="co"># Will use default random seed</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">t0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">temp_output_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="st">"eam_demo_post_output"</span><span class="op">)</span></span>
<span><span class="va">sim_output_post</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_simulation.html">run_simulation</a></span><span class="op">(</span>config <span class="op">=</span> <span class="va">sim_config_post</span>, output_dir <span class="op">=</span> <span class="va">temp_output_path</span><span class="op">)</span></span>
<span></span>
<span><span class="va">post_output</span> <span class="op">&lt;-</span> <span class="va">sim_output_post</span></span>
<span><span class="va">observed_data</span><span class="op">$</span><span class="va">item_idx</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co"># Plot the posterior rt and accuracy</span></span>
<span><span class="fu"><a href="../reference/plot_rt.html">plot_rt</a></span><span class="op">(</span></span>
<span>  <span class="va">post_output</span>,</span>
<span>  <span class="va">observed_data</span>,</span>
<span>  facet_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"item_idx"</span><span class="op">)</span>,</span>
<span>  facet_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="10-minimal-workflow/unnamed-chunk-10-1.svg" alt="plot of chunk unnamed-chunk-10"><div class="figcaption">plot of chunk unnamed-chunk-10</div>
</div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/plot_accuracy.html">plot_accuracy</a></span><span class="op">(</span></span>
<span>  <span class="va">post_output</span>,</span>
<span>  <span class="va">observed_data</span>,</span>
<span>  facet_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  facet_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="10-minimal-workflow/unnamed-chunk-10-2.svg" alt="plot of chunk unnamed-chunk-10"><div class="figcaption">plot of chunk unnamed-chunk-10</div>
</div>
<p>Beyond parameter estimation, the <strong>eam</strong> package also
supports model comparison within a simulation-based inference
framework.</p>
<p>In this example, we construct an alternative model by deliberately
modifying the prior specification of the relative starting point
parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>,
while keeping all other components of the model unchanged. This allows
us to isolate the contribution of this parameter assumption to overall
model fit. Synthetic data are then generated under the alternative
model, and the same summary statistics pipeline is applied to ensure
comparability across models.</p>
<p>Model comparison is conducted using the <em>abc_postpr()</em>
function, which estimates posterior model probabilities based on
Approximate Bayesian Computation. Intuitively, this procedure assesses
which model is more likely to have generated the observed data by
comparing the proximity of simulated summary statistics from each model
to the target summary statistics, given a fixed tolerance level.</p>
<p>The resulting posterior probabilities indicate the relative
likelihood that the observed data were generated by each candidate
model. These probabilities can be summarized using Bayes factors, which
quantify the strength of evidence in favor of one model over another.
Conventionally, Bayes factors greater than 3 or smaller than 1/3 are
interpreted as providing substantial evidence for one model relative to
its competitor.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Deliberately change the rho in the alternative model</span></span>
<span><span class="va">prior_formulas_alt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="co"># Decision boundary</span></span>
<span>  <span class="va">A_0</span> <span class="op">~</span> <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_uniform.html" class="external-link">dist_uniform</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  <span class="co"># Drift rate</span></span>
<span>  <span class="va">V_0</span> <span class="op">~</span> <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_uniform.html" class="external-link">dist_uniform</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  <span class="co"># Non-decision time</span></span>
<span>  <span class="va">ndt_0</span> <span class="op">~</span> <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_uniform.html" class="external-link">dist_uniform</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="co"># Relative starting point</span></span>
<span>  <span class="va">rho_0</span> <span class="op">~</span> <span class="fl">0.7</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim_config_alt</span> <span class="op">&lt;-</span> <span class="va">sim_config</span></span>
<span><span class="va">sim_config_alt</span><span class="op">$</span><span class="va">prior_formulas</span> <span class="op">&lt;-</span> <span class="va">prior_formulas_alt</span></span>
<span></span>
<span><span class="va">temp_output_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="st">"eam_demo_output_alt"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run the simulation</span></span>
<span><span class="va">sim_output_alt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_simulation.html">run_simulation</a></span><span class="op">(</span></span>
<span>  config <span class="op">=</span> <span class="va">sim_config_alt</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="va">temp_output_path</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate simulated summary statistics for the alternative model</span></span>
<span><span class="va">simulation_sumstat_alt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map_by_condition.html">map_by_condition</a></span><span class="op">(</span></span>
<span>  <span class="va">sim_output_alt</span>,</span>
<span>  .progress <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  .parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">cond_df</span><span class="op">)</span> <span class="fu">summary_pipe</span><span class="op">(</span><span class="va">cond_df</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">abc_input_alt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_abc_input.html">build_abc_input</a></span><span class="op">(</span></span>
<span>  simulation_output <span class="op">=</span> <span class="va">sim_output_alt</span>,</span>
<span>  simulation_summary <span class="op">=</span> <span class="va">simulation_sumstat_alt</span>,</span>
<span>  target_summary <span class="op">=</span> <span class="va">target_sumstat</span>,</span>
<span>  param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A_0"</span>,<span class="st">"V_0"</span>,<span class="st">"ndt_0"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run the model comparison</span></span>
<span><span class="va">postpr_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/abc_postpr.html">abc_postpr</a></span><span class="op">(</span></span>
<span>  sumstats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="va">abc_input</span><span class="op">$</span><span class="va">sumstat</span>,</span>
<span>    <span class="va">abc_input_alt</span><span class="op">$</span><span class="va">sumstat</span></span>
<span>  <span class="op">)</span>,</span>
<span>  target <span class="op">=</span> <span class="va">abc_input</span><span class="op">$</span><span class="va">target</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"rejection"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">postpr_result</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call: </span></span>
<span><span class="co">#&gt; abc::postpr(target = target, index = index, sumstat = sumstat, </span></span>
<span><span class="co">#&gt;     tol = 0.05, method = "rejection")</span></span>
<span><span class="co">#&gt; Data:</span></span>
<span><span class="co">#&gt;  postpr.out$values (100 posterior samples)</span></span>
<span><span class="co">#&gt; Models a priori:</span></span>
<span><span class="co">#&gt;  model_1, model_2</span></span>
<span><span class="co">#&gt; Models a posteriori:</span></span>
<span><span class="co">#&gt;  model_1, model_2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Proportion of accepted simulations (rejection):</span></span>
<span><span class="co">#&gt; model_1 model_2 </span></span>
<span><span class="co">#&gt;    0.59    0.41 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Bayes factors:</span></span>
<span><span class="co">#&gt;         model_1 model_2</span></span>
<span><span class="co">#&gt; model_1  1.0000  1.4390</span></span>
<span><span class="co">#&gt; model_2  0.6949  1.0000</span></span></code></pre></div>
<p>According to the results, the model comparison indicated moderate
evidence in favor of the model with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÅ</mi><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">\rho = 0.5</annotation></semantics></math>
(the correct
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
configuration) over the model with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÅ</mi><mo>=</mo><mn>0.7</mn></mrow><annotation encoding="application/x-tex">\rho = 0.7</annotation></semantics></math>
(the incorrect
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
configuration), with a posterior probability of 0.87 and a Bayes factor
of approximately 6.7.</p>
<p>This is the end of this example.</p>
<p>This simple DDM example serves as a reference template for the rest
of the tutorial. Once this workflow is clear, extending it to more
complex models in eam mainly involves modifying the model components,
while the overall inference pipeline remains unchanged.</p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Guangyu Zhu, Guang Yang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
