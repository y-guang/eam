# Build input for Amortized Bayesian Inference (ABI)

Prepares simulation output for Amortized Bayesian Inference (ABI)
analysis using the `NeuralEstimators` package. Extracts parameters and
summary statistics from simulation results, splits data into training
and validation sets, and formats them into matrices suitable for neural
network training.

## Usage

``` r
build_abi_input(
  simulation_output,
  theta,
  Z,
  train_ratio = 0.8,
  rank_levels = NULL
)
```

## Arguments

- simulation_output:

  A eam_simulation_output object from
  [`run_simulation`](https://y-guang.github.io/eam/reference/run_simulation.md)
  or
  [`load_simulation_output`](https://y-guang.github.io/eam/reference/load_simulation_output.md).

- theta:

  Character vector of parameter names to extract from simulation_output.
  These parameters will be used as the target variables for inference.

- Z:

  Character vector of summary statistic column names to extract from the
  simulation output dataset (e.g., "rt", "item_idx", "choice").

- train_ratio:

  Numeric value between 0 and 1 specifying the proportion of conditions
  to use for training (default: 0.8).

- rank_levels:

  Numeric vector specifying which rank indices to include. If NULL
  (default), uses all ranks from 1 to n_items from simulation config.

## Value

A list with components suitable for `abi` package training:

- theta_train:

  Matrix of training parameters (parameters × conditions)

- theta_val:

  Matrix of validation parameters (parameters × conditions)

- Z_train:

  List of matrices, one per training condition (ranks\*Z × trials)

- Z_val:

  List of matrices, one per validation condition (ranks\*Z × trials)

- train_idx:

  Vector of condition indices used for training

- val_idx:

  Vector of condition indices used for validation

- train_ratio:

  The training ratio used

- rank_levels:

  The rank levels included in Z matrices

## Details

This function provides a streamlined workflow for preparing ABI inputs.
It requires that `simulation_output` be created by
[`run_simulation`](https://y-guang.github.io/eam/reference/run_simulation.md)
or
[`load_simulation_output`](https://y-guang.github.io/eam/reference/load_simulation_output.md).
The function automatically handles missing trials and ranks by filling
with zeros to ensure complete data matrices.

The output format is optimized for the `abi` package's training
functions, with parameters formatted as matrices (each column is a
condition) and summary statistics formatted as lists of matrices (one
per condition, with trials as columns).

## Examples

``` r
# Load the example dataset
rdm_minimal_example <- system.file("extdata", "rdm_minimal", package = "eam")
sim_output <- load_simulation_output(file.path(rdm_minimal_example, "simulation"))

# build the ABI input
abi_input <- build_abi_input(
  sim_output,
  c(
    "V_beta_1",
    "V_beta_group"
  ),
  c(
    "item_idx",
    "rt",
    "choice"
  )
)

# view the structure of the ABI input
str(abi_input)
#> List of 8
#>  $ theta_train: num [1:2, 1:400] 0.579 0.265 0.602 0.141 0.239 ...
#>   ..- attr(*, "dimnames")=List of 2
#>   .. ..$ : chr [1:2] "V_beta_1" "V_beta_group"
#>   .. ..$ : NULL
#>  $ theta_val  : num [1:2, 1:100] 0.121 0.248 0.214 0.136 0.95 ...
#>   ..- attr(*, "dimnames")=List of 2
#>   .. ..$ : chr [1:2] "V_beta_1" "V_beta_group"
#>   .. ..$ : NULL
#>  $ Z_train    :List of 400
#>   ..$ : num [1:9, 1:100] 3 1 2 0.339 0.549 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 2 3 0.21 0.223 0.731 1 1 1 1 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 1 3 0.334 0.484 0.657 1 1 1 2 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.104 0.105 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 3 2 0.827 0.928 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.63 1.35 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.22 0.433 0.606 1 -1 1 2 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.194 0.592 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.337 0.576 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.525 0.968 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 1 3 0.505 0.645 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.434 0.456 0.543 1 1 1 1 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.149 1.63 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 3 2 0.43 0.61 0.765 -1 1 1 1 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.119 0.383 0.909 1 1 -1 1 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.245 0.536 0.576 1 1 1 3 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.249 0.316 0.609 1 -1 1 3 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.27 0.325 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.256 0.481 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.3 0.97 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.41 0.841 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.286 0.428 0.93 1 1 1 3 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 1 3 0.275 0.279 0.413 1 1 1 3 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.644 1.241 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.138 0.237 0.443 1 1 -1 3 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 1 3 0.338 0.378 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.314 0.44 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 2 3 0.383 0.553 0.592 1 1 1 2 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.535 0.556 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 3 2 0.297 1.24 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 2 3 0.227 0.371 0.384 1 1 1 1 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.125 0.691 0.796 1 1 1 2 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.288 0.344 0.469 1 1 1 3 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.12 2.06 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.49 0.631 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.437 0.449 0.546 1 1 1 3 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.323 0.423 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.315 0.66 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 3 2 0.193 0.213 0.427 1 1 1 3 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.448 0.479 0.55 1 1 -1 3 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 1 3 0.105 0.421 0.761 1 1 1 2 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.385 0.485 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 1.01 1.73 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.189 0.309 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 3 2 0.201 0.294 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.145 0.239 0.352 1 1 1 2 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 1.36 1.52 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 3 2 0.382 0.599 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 1 3 0.331 1.021 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 1 3 0.174 0.856 0.889 1 1 1 2 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 1 3 0.186 0.457 0.5 1 1 1 3 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.139 0.794 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.215 0.299 0.763 1 1 1 2 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.359 0.561 0.771 1 -1 1 1 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.468 0.582 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.362 0.728 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.383 0.544 0.553 1 1 1 3 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.27 0.646 0.712 1 1 1 3 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.429 0.531 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.2 0.407 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.196 1.262 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.605 1.111 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.715 1.42 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 2 3 0.225 0.247 0.26 -1 -1 -1 3 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.388 0.559 0.629 1 1 1 1 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.355 0.476 0.751 1 1 1 2 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.268 0.384 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.172 0.526 0.553 1 1 1 2 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.178 0.801 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 2 3 0.526 1.013 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 2 3 0.366 0.873 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 3 2 0.295 0.55 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 2 3 0.297 0.44 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.278 0.731 0.74 1 1 1 2 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.236 0.251 0.549 1 1 1 3 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 1.19 1.51 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.312 0.794 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.196 0.26 0.615 1 -1 1 2 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 1 3 0.29 0.53 0.666 1 -1 1 2 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.393 0.47 0.82 -1 1 1 1 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.866 1.259 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.211 0.461 0.466 1 1 -1 2 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.387 0.747 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 2 3 0.818 1.499 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.926 1.165 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 1 3 0.383 1.644 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 3 2 0.359 0.375 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 2 3 0.265 0.72 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 3 2 0.213 0.356 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 2 3 0.503 0.667 0.787 -1 1 -1 1 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 3 2 0.271 0.34 0.432 1 1 1 2 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.245 0.304 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.145 1.344 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.164 1.206 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.349 0.676 0.999 1 1 1 1 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 1 3 0.224 0.595 0.651 1 1 1 3 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.259 1.124 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.454 0.525 0.716 1 1 1 3 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 1 3 0.505 1.144 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   .. [list output truncated]
#>  $ Z_val      :List of 100
#>   ..$ : num [1:9, 1:100] 2 3 1 0.391 1.068 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.681 0.892 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.268 0.598 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.27 0.285 0.759 1 -1 1 1 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.338 1.489 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 3 2 0.508 0.54 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 3 2 0.73 0.858 0.894 1 1 1 1 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 1 3 0.643 0.756 0.943 -1 1 1 1 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 3 2 0.287 1.052 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 2 3 0.219 0.544 0.717 1 1 1 1 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 3 2 0.449 0.928 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.391 0.655 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.338 0.723 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 1 3 0.198 0.538 0.752 1 1 1 2 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.475 0.522 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 3 2 0.239 0.614 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.232 0.954 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.36 0.408 0.461 1 1 1 2 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.293 0.416 0.635 1 1 1 2 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.47 0.56 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.809 0.826 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.199 0.519 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.172 0.307 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 1 3 0.72 1.37 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 3 2 0.667 0.731 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.327 0.811 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 3 2 0.259 0.487 0.978 -1 -1 -1 3 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.346 0.425 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.382 0.412 0.656 1 1 1 3 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.238 0.473 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.226 0.286 0.691 1 1 -1 2 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.344 0.739 0.954 -1 -1 -1 2 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.266 0.499 0.532 1 -1 -1 1 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.12 0.677 0.806 1 1 1 2 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 1 3 0.422 0.614 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 3 2 0.17 0.939 0.978 1 1 1 3 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.24 0.442 0.548 1 1 1 1 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 3 2 0.198 0.609 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.35 0.558 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 1 3 0.802 0.88 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 3 2 0.148 0.243 0.639 1 1 1 1 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 2 3 0.43 0.529 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 1 3 1.36 1.47 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.1 0.449 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.566 1.128 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 2 3 0.142 1.745 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 3 2 0.494 0.677 0.815 -1 1 1 3 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 1.08 1.1 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.423 0.918 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 1 3 0.396 0.42 0.629 1 -1 -1 3 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.362 0.409 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 1 3 0.295 0.381 0.767 1 -1 1 3 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 3 2 0.828 0.92 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.13 0.136 0.568 1 1 1 2 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.363 0.618 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.111 0.905 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.21 0.278 0.933 1 1 1 2 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.334 0.897 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 1 3 0.166 0.335 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.486 0.601 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.437 0.64 0.714 -1 1 1 2 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 3 2 0.169 0.624 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.143 0.248 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 3 2 0.455 1.673 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 2 3 0.662 1.313 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.317 1.263 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.183 0.628 0.703 1 1 1 2 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.532 1.069 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.229 0.519 0.769 1 1 1 3 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.252 0.282 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.437 0.638 0.65 1 1 1 2 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.262 0.4 0.575 1 1 1 1 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 1 3 0.323 0.53 0.708 1 1 1 3 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.213 0.227 0.39 1 1 1 1 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.386 0.433 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.433 0.637 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 3 2 0.59 0.642 0.697 1 1 1 1 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.688 0.816 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.538 1.402 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 1 3 0.143 0.995 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 2 3 0.245 0.428 0.836 1 -1 -1 2 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.294 0.353 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.11 0.266 0.571 1 1 1 1 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 2 3 0.277 0.426 0.645 -1 -1 1 1 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 1 3 0.182 0.419 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 1 2 0.271 0.391 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.284 0.748 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.346 0.88 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 3 2 1 0.186 0.425 0.605 1 1 1 1 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.633 0.875 0.945 1 1 -1 3 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 1 3 0.947 0.966 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.952 1.436 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 1 3 0.46 1.07 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 3 2 0.291 0.382 0.411 1 1 1 3 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 3 2 0.293 0.381 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 3 2 0.354 0.603 0.608 -1 1 -1 3 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 3 2 0.305 0.397 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 2 3 1 0.177 0.198 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   ..$ : num [1:9, 1:100] 1 2 3 0.429 0.714 ...
#>   .. ..- attr(*, "dimnames")=List of 2
#>   .. .. ..$ : chr [1:9] "rank_1_item_idx" "rank_2_item_idx" "rank_3_item_idx" "rank_1_rt" ...
#>   .. .. ..$ : NULL
#>   .. [list output truncated]
#>  $ train_idx  : int [1:400] 443 166 365 237 25 309 163 45 210 407 ...
#>  $ val_idx    : int [1:100] 2 9 22 33 35 47 53 62 64 66 ...
#>  $ train_ratio: num 0.8
#>  $ rank_levels: int [1:3] 1 2 3

if (FALSE) { # \dontrun{
# Example of using the ABI input for training
# (requires NeuralEstimators package and build your estimator first, see our tutorials)
train(
  estimator,
  theta_train = abi_input$theta_train,
  theta_val = abi_input$theta_val,
  Z_train = abi_input$Z_train,
  Z_val = abi_input$Z_val,
  epochs = 500,
  stopping_epochs = 200
)
} # }
```
