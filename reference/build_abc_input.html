<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Build input for Approximate Bayesian Computation (ABC) — build_abc_input • eam</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Build input for Approximate Bayesian Computation (ABC) — build_abc_input"><meta name="description" content="Prepares simulation output, summary statistics, and target data for ABC
analysis using the abc package. Extracts parameters and summary
statistics from simulation results and formats them into matrices suitable
for ABC parameter estimation."><meta property="og:description" content="Prepares simulation output, summary statistics, and target data for ABC
analysis using the abc package. Extracts parameters and summary
statistics from simulation results and formats them into matrices suitable
for ABC parameter estimation."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">eam</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/template-article.html">Template Article</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Developer Guide</h6></li>
    <li><a class="dropdown-item" href="../articles/developer-guide.html">Developer Guide</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Chinese Translation</h6></li>
    <li><a class="dropdown-item" href="../articles/about-zh-translation.html">About Chinese Translation</a></li>
    <li><a class="dropdown-item" href="../articles/developer-guide.zh.html">开发人员引导</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/y-guang/eam/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Build input for Approximate Bayesian Computation (ABC)</h1>
      <small class="dont-index">Source: <a href="https://github.com/y-guang/eam/blob/main/R/abc_input.R" class="external-link"><code>R/abc_input.R</code></a></small>
      <div class="d-none name"><code>build_abc_input.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Prepares simulation output, summary statistics, and target data for ABC
analysis using the <code>abc</code> package. Extracts parameters and summary
statistics from simulation results and formats them into matrices suitable
for ABC parameter estimation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">build_abc_input</span><span class="op">(</span><span class="va">simulation_output</span>, <span class="va">simulation_summary</span>, <span class="va">target_summary</span>, <span class="va">param</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-simulation-output">simulation_output<a class="anchor" aria-label="anchor" href="#arg-simulation-output"></a></dt>
<dd><p>A eam_simulation_output object containing that is from
<code><a href="run_simulation.html">run_simulation</a></code> or <code><a href="load_simulation_output.html">load_simulation_output</a></code>.</p></dd>


<dt id="arg-simulation-summary">simulation_summary<a class="anchor" aria-label="anchor" href="#arg-simulation-summary"></a></dt>
<dd><p>A data frame containing summary statistics for each
simulated condition. Should have a 'condition_idx' column and be created by
<code><a href="summarise_by.html">summarise_by</a></code>.</p></dd>


<dt id="arg-target-summary">target_summary<a class="anchor" aria-label="anchor" href="#arg-target-summary"></a></dt>
<dd><p>A data frame containing target summary statistics to match
against simulation results. Should have the same summary statistic columns as
simulation_summary (excluding 'wider_by' columns).</p></dd>


<dt id="arg-param">param<a class="anchor" aria-label="anchor" href="#arg-param"></a></dt>
<dd><p>Character vector of parameter names to extract from simulation_output.
These parameters will be used as the parameter space for ABC estimation.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with components suitable for <code><a href="https://rdrr.io/pkg/abc/man/abc.html" class="external-link">abc::abc</a></code></p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function provides a streamlined workflow for preparing ABC inputs, but
it requires that all components be constructed using this package's functions.
Specifically, <code>simulation_output</code> must be created by <code><a href="run_simulation.html">run_simulation</a></code>
or <code><a href="load_simulation_output.html">load_simulation_output</a></code>, and both <code>simulation_summary</code> and
<code>target_summary</code> must be generated using <code><a href="summarise_by.html">summarise_by</a></code>. If
your data originates from external sources or custom pipelines, you should
manually construct the ABC input list instead, ensuring proper matrix formatting
and column alignment as expected by <code><a href="https://rdrr.io/pkg/abc/man/abc.html" class="external-link">abc::abc</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="required-format-for-summary-statistics">Required format for summary statistics<a class="anchor" aria-label="anchor" href="#required-format-for-summary-statistics"></a></h2>


<p>Both <code>simulation_summary</code> and <code>target_summary</code> must be created using
<code><a href="summarise_by.html">summarise_by</a></code>.
This ensures consistent column naming and data structure required for ABC analysis.
See <code><a href="summarise_by.html">summarise_by</a></code> for details on generating properly formatted summaries,
and <code><a href="map_by_condition.html">map_by_condition</a></code> for typical workflow examples.
If you want more flexibility in summary statistic calculation, you can manually
construct the ABC input list. It is not necessary to use this function if you
are familiar with the <code>abc</code> package.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Load the example dataset</span></span></span>
<span class="r-in"><span><span class="va">rdm_minimal_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"rdm_minimal"</span>, package <span class="op">=</span> <span class="st">"eam"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sim_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="load_simulation_output.html">load_simulation_output</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">rdm_minimal_example</span>, <span class="st">"simulation"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in load_simulation_output(file.path(rdm_minimal_example, "simulation")):</span> Output directory does not exist: /simulation</span>
<span class="r-in"><span><span class="va">obs_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">rdm_minimal_example</span>, <span class="st">"observation"</span>, <span class="st">"observation_data.csv"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>cannot open file '/observation/observation_data.csv': No such file or directory</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in file(file, "rt"):</span> cannot open the connection</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define summary statistics pipeline</span></span></span>
<span class="r-in"><span><span class="va">summary_pipe</span> <span class="op">&lt;-</span> <span class="fu"><a href="summarise_by.html">summarise_by</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  .by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"condition_idx"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  rt_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">rt</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate summary statistics for simulation and observation</span></span></span>
<span class="r-in"><span><span class="va">sim_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="map_by_condition.html">map_by_condition</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">sim_output</span>,</span></span>
<span class="r-in"><span>  .progress <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  .parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  <span class="kw">function</span><span class="op">(</span><span class="va">cond_df</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu">summary_pipe</span><span class="op">(</span><span class="va">cond_df</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'sim_output' not found</span>
<span class="r-in"><span><span class="va">obs_summary</span> <span class="op">&lt;-</span> <span class="fu">summary_pipe</span><span class="op">(</span><span class="va">obs_df</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'obs_df' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Build ABC input</span></span></span>
<span class="r-in"><span><span class="va">abc_input</span> <span class="op">&lt;-</span> <span class="fu">build_abc_input</span><span class="op">(</span></span></span>
<span class="r-in"><span>  simulation_output <span class="op">=</span> <span class="va">sim_output</span>,</span></span>
<span class="r-in"><span>  simulation_summary <span class="op">=</span> <span class="va">sim_summary</span>,</span></span>
<span class="r-in"><span>  target_summary <span class="op">=</span> <span class="va">obs_summary</span>,</span></span>
<span class="r-in"><span>  param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"V_beta_1"</span>, <span class="st">"V_beta_group"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'sim_output' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Perform ABC parameter estimation using rejection method</span></span></span>
<span class="r-in"><span><span class="va">abc_rejection_model</span> <span class="op">&lt;-</span> <span class="fu">abc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/abc/man/abc.html" class="external-link">abc</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  target <span class="op">=</span> <span class="va">abc_input</span><span class="op">$</span><span class="va">target</span>,</span></span>
<span class="r-in"><span>  param <span class="op">=</span> <span class="va">abc_input</span><span class="op">$</span><span class="va">param</span>,</span></span>
<span class="r-in"><span>  sumstat <span class="op">=</span> <span class="va">abc_input</span><span class="op">$</span><span class="va">sumstat</span>,</span></span>
<span class="r-in"><span>  tol <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="st">"rejection"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'abc_input' not found</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Guangyu Zhu, Guang Yang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

