<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Evidence Accumulation Models ‚Ä¢ eam</title>
<script src="lightswitch.js"></script><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Evidence Accumulation Models">
<meta name="description" content="Simulation-based evidence accumulation models for analyzing responses and reaction times in single- and multi-response tasks. The package includes simulation engines for five representative models: the Diffusion Decision Model (DDM), Leaky Competing Accumulator (LCA), Linear Ballistic Accumulator (LBA), Racing Diffusion Model (RDM), and Levy Flight Model (LFM), and extends these frameworks to multi-response settings. The package supports user-defined functions for item-level parameterization and the incorporation of covariates, enabling flexible customization and the development of new model variants based on existing architectures. Inference is performed using simulation-based methods, including Approximate Bayesian Computation (ABC) and Amortized Bayesian Inference (ABI), which allow parameter estimation without requiring tractable likelihood functions. In addition to core inference tools, the package provides modules for parameter recovery, posterior predictive checks, and model comparison, facilitating the study of a wide range of cognitive processes in tasks involving perceptual decision making, memory retrieval, and value-based decision making. Key methods implemented in the package are described in Ratcliff (1978) &lt;doi:10.1037/0033-295X.85.2.59&gt;, Usher and McClelland (2001) &lt;doi:10.1037/0033-295X.108.3.550&gt;, Brown and Heathcote (2008) &lt;doi:10.1016/j.cogpsych.2007.12.002&gt;, Tillman, Van Zandt and Logan (2020) &lt;doi:10.3758/s13423-020-01719-6&gt;, Wieschen, Voss and Radev (2020) &lt;doi:10.20982/tqmp.16.2.p120&gt;, Csill√©ry, Fran√ßois and Blum (2012) &lt;doi:10.1111/j.2041-210X.2011.00179.x&gt;, Beaumont (2019) &lt;doi:10.1146/annurev-statistics-030718-105212&gt;, and Sainsbury-Dale, Zammit-Mangion and Huser (2024) &lt;doi:10.1080/00031305.2023.2249522&gt;.">
<meta property="og:description" content="Simulation-based evidence accumulation models for analyzing responses and reaction times in single- and multi-response tasks. The package includes simulation engines for five representative models: the Diffusion Decision Model (DDM), Leaky Competing Accumulator (LCA), Linear Ballistic Accumulator (LBA), Racing Diffusion Model (RDM), and Levy Flight Model (LFM), and extends these frameworks to multi-response settings. The package supports user-defined functions for item-level parameterization and the incorporation of covariates, enabling flexible customization and the development of new model variants based on existing architectures. Inference is performed using simulation-based methods, including Approximate Bayesian Computation (ABC) and Amortized Bayesian Inference (ABI), which allow parameter estimation without requiring tractable likelihood functions. In addition to core inference tools, the package provides modules for parameter recovery, posterior predictive checks, and model comparison, facilitating the study of a wide range of cognitive processes in tasks involving perceptual decision making, memory retrieval, and value-based decision making. Key methods implemented in the package are described in Ratcliff (1978) &lt;doi:10.1037/0033-295X.85.2.59&gt;, Usher and McClelland (2001) &lt;doi:10.1037/0033-295X.108.3.550&gt;, Brown and Heathcote (2008) &lt;doi:10.1016/j.cogpsych.2007.12.002&gt;, Tillman, Van Zandt and Logan (2020) &lt;doi:10.3758/s13423-020-01719-6&gt;, Wieschen, Voss and Radev (2020) &lt;doi:10.20982/tqmp.16.2.p120&gt;, Csill√©ry, Fran√ßois and Blum (2012) &lt;doi:10.1111/j.2041-210X.2011.00179.x&gt;, Beaumont (2019) &lt;doi:10.1146/annurev-statistics-030718-105212&gt;, and Sainsbury-Dale, Zammit-Mangion and Huser (2024) &lt;doi:10.1080/00031305.2023.2249522&gt;.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">eam</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="articles/template-article.html">Template Article</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/y-guang/eam/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="eam">eam<a class="anchor" aria-label="anchor" href="#eam"></a>
</h1></div>
<p>eam is a simulation-based evidence accumulation models for analyzing responses and reaction times in single- and multi-response tasks. The package includes simulation engines for five representative models: the Diffusion Decision Model (DDM), Leaky Competing Accumulator (LCA), Linear Ballistic Accumulator (LBA), Racing Diffusion Model (RDM), and L√©vy Flight Model (LFM), and extends these frameworks to multi-response settings.</p>
<p>The package supports user-defined functions for item-level parameterization and the incorporation of covariates, enabling flexible customization and the development of new model variants based on existing architectures. Inference is performed using simulation-based methods, including Approximate Bayesian Computation (ABC) and Amortized Bayesian Inference (ABI), which allow parameter estimation without requiring tractable likelihood functions.</p>
<p>In addition to core inference tools, the package provides modules for parameter recovery, posterior predictive checks, and model comparison. Overall, it facilitates the study of a wide range of cognitive processes in tasks involving perceptual decision making, memory retrieval, and value-based decision making.</p>
<div class="section level2">
<h2 id="features">Features<a class="anchor" aria-label="anchor" href="#features"></a>
</h2>
<ul>
<li>‚öôÔ∏è High-Performance Backend
<ul>
<li>
<strong>Pure C++ core</strong> with fast vectorization-friendly algorithms designed. 100x speedup compared with naive python implementations.</li>
<li>Memory-efficient computation, enabling more than <strong>10 million</strong> trials on a standard desktop machine.</li>
<li>Parallel execution with near-linear speed-up across multiple CPU cores.</li>
</ul>
</li>
<li>üß© Modern API
<ul>
<li>Flexible architecture: composable api, defines several formulas, you can easily customize your own models.</li>
<li>modern R apiÔºöBuilt around modern R conventions, it provides a declarative, tidy-style interface.</li>
<li>Unified data pipeline: provides a consistent set of data manipulation and summarization utilities for seamless simulation, evaluation, and visualization.</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="quick-start">Quick Start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<p>The following example demonstrates a complete workflow. For more example, please refer to the corresponding repository demo folder. As it is quite computationally intensive, it is not included in the vignettes.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">###############</span></span>
<span><span class="co"># model setup #</span></span>
<span><span class="co">###############</span></span>
<span><span class="va">n_items</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">prior_formulas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="va">n_items</span> <span class="op">~</span> <span class="fl">10</span>,</span>
<span>  <span class="co"># parameters with distributions</span></span>
<span>  <span class="va">A_beta_0</span> <span class="op">~</span> <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_uniform.html" class="external-link">dist_uniform</a></span><span class="op">(</span><span class="fl">1.00</span>, <span class="fl">10.00</span><span class="op">)</span>,</span>
<span>  <span class="va">A_beta_1</span> <span class="op">~</span> <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_uniform.html" class="external-link">dist_uniform</a></span><span class="op">(</span><span class="fl">1.00</span>, <span class="fl">10.00</span><span class="op">)</span>,</span>
<span>  <span class="co"># V</span></span>
<span>  <span class="va">V_beta_0</span> <span class="op">~</span> <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_uniform.html" class="external-link">dist_uniform</a></span><span class="op">(</span><span class="fl">1.0</span>, <span class="fl">5.0</span><span class="op">)</span>,</span>
<span>  <span class="va">V_beta_1</span> <span class="op">~</span> <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_uniform.html" class="external-link">dist_uniform</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.50</span>, <span class="op">-</span><span class="fl">0.01</span><span class="op">)</span>,</span>
<span>  <span class="co"># ndt</span></span>
<span>  <span class="va">ndt</span> <span class="op">~</span> <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_uniform.html" class="external-link">dist_uniform</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">3.00</span><span class="op">)</span>,</span>
<span>  <span class="co"># noise param</span></span>
<span>  <span class="va">noise_coef</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  <span class="co"># between trial varibaility</span></span>
<span>  <span class="va">sigma</span> <span class="op">~</span> <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_uniform.html" class="external-link">dist_uniform</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">3.00</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">between_trial_formulas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="va">V_var</span> <span class="op">~</span> <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_normal.html" class="external-link">dist_normal</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">sigma</span><span class="op">)</span>,</span>
<span>  <span class="co"># random group binomial</span></span>
<span>  <span class="va">group</span> <span class="op">~</span> <span class="fu">distributional</span><span class="fu">::</span><span class="fu"><a href="https://pkg.mitchelloharawild.com/distributional/reference/dist_binomial.html" class="external-link">dist_binomial</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">item_formulas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="va">A_upper</span> <span class="op">~</span> <span class="va">A_beta_0</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n_items</span><span class="op">)</span> <span class="op">*</span> <span class="va">A_beta_1</span>,</span>
<span>  <span class="va">A_lower</span> <span class="op">~</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>  <span class="va">V</span> <span class="op">~</span> <span class="va">V_beta_0</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n_items</span><span class="op">)</span> <span class="op">*</span> <span class="va">V_beta_1</span> <span class="op">+</span> <span class="va">V_var</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">noise_factory</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">context</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">noise_coef</span> <span class="op">&lt;-</span> <span class="va">context</span><span class="op">$</span><span class="va">noise_coef</span></span>
<span></span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">dt</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">noise_coef</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">dt</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">####################</span></span>
<span><span class="co"># simulation setup #</span></span>
<span><span class="co">####################</span></span>
<span><span class="va">sim_config</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/new_simulation_config.html">new_simulation_config</a></span><span class="op">(</span></span>
<span>  prior_formulas <span class="op">=</span> <span class="va">prior_formulas</span>,</span>
<span>  between_trial_formulas <span class="op">=</span> <span class="va">between_trial_formulas</span>,</span>
<span>  item_formulas <span class="op">=</span> <span class="va">item_formulas</span>,</span>
<span>  n_conditions_per_chunk <span class="op">=</span> <span class="cn">NULL</span>, <span class="co"># automatic chunking</span></span>
<span>  n_conditions <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  n_trials_per_condition <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  n_items <span class="op">=</span> <span class="va">n_items</span>,</span>
<span>  max_reached <span class="op">=</span> <span class="va">n_items</span>,</span>
<span>  max_t <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  dt <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  noise_mechanism <span class="op">=</span> <span class="st">"add"</span>,</span>
<span>  noise_factory <span class="op">=</span> <span class="va">noise_factory</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"ddm"</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="cn">NULL</span>, <span class="co"># Will use default: detectCores() - 1</span></span>
<span>  rand_seed <span class="op">=</span> <span class="cn">NULL</span> <span class="co"># Will use default random seed</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sim_config</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># output temporary path setup</span></span>
<span><span class="va">temp_base_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="st">"eam_demo"</span><span class="op">)</span></span>
<span><span class="co"># remove if exists</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.exists</a></span><span class="op">(</span><span class="va">temp_base_path</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">temp_base_path</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">temp_output_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">temp_base_path</span>, <span class="st">"output"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Temporary base path:\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">temp_base_path</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">##################</span></span>
<span><span class="co"># run simulation #</span></span>
<span><span class="co">##################</span></span>
<span><span class="va">sim_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/run_simulation.html">run_simulation</a></span><span class="op">(</span></span>
<span>  config <span class="op">=</span> <span class="va">sim_config</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="va">temp_output_path</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#####################</span></span>
<span><span class="co"># abc model prepare #</span></span>
<span><span class="co">#####################</span></span>
<span><span class="co"># preview the output data variables</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sim_output</span><span class="op">$</span><span class="fu">open_dataset</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># uncommented to collect all data into memory (avoid for large sims)</span></span>
<span><span class="co"># sim_output_df &lt;- sim_output$open_dataset() |&gt; dplyr::collect()</span></span>
<span><span class="co"># uncommented to collect all condition parameters into memory</span></span>
<span><span class="co"># sim_condition_df &lt;- sim_output$open_evaluated_conditions() |&gt; dplyr::collect()</span></span>
<span></span>
<span><span class="co"># define the summary procedure</span></span>
<span><span class="va">summary_pipe</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="reference/summarise_by.html">summarise_by</a></span><span class="op">(</span></span>
<span>    .by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"condition_idx"</span><span class="op">)</span>,</span>
<span>    <span class="co"># single value</span></span>
<span>    rt_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">rt</span><span class="op">)</span>,</span>
<span>    <span class="co"># named vector</span></span>
<span>    rt_quantiles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">rt</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="co"># regression coefficients</span></span>
<span>    lm_coef <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">rt</span> <span class="op">~</span> <span class="va">item_idx</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span>,</span>
<span>    <span class="co"># complex functions</span></span>
<span>    aic <span class="op">=</span> <span class="op">{</span></span>
<span>      <span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">rt</span> <span class="op">~</span> <span class="va">item_idx</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">$</span><span class="va">aic</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/summarise_by.html">summarise_by</a></span><span class="op">(</span></span>
<span>    .by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"condition_idx"</span>, <span class="st">"item_idx"</span><span class="op">)</span>,</span>
<span>    rt_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">rt</span><span class="op">)</span>,</span>
<span>    rt_quantiles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">rt</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># summarise simulation output</span></span>
<span><span class="va">simulation_sumstat</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/map_by_condition.html">map_by_condition</a></span><span class="op">(</span></span>
<span>  <span class="va">sim_output</span>,</span>
<span>  .progress <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  .parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">cond_df</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># clean data here</span></span>
<span>    <span class="va">complete_df</span> <span class="op">&lt;-</span> <span class="va">cond_df</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">V_beta_0</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">rt</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="co"># extract the summary by calling spec directly</span></span>
<span>    <span class="fu">summary_pipe</span><span class="op">(</span><span class="va">complete_df</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># clean non-complete simulations</span></span>
<span><span class="va">simulation_sumstat</span> <span class="op">&lt;-</span> <span class="va">simulation_sumstat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span><span class="va">simulation_sumstat</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># summarized observed/target data</span></span>
<span><span class="co"># pretend observed data is condition 1</span></span>
<span><span class="co"># you should load your own observed data here and rename columns accordingly</span></span>
<span><span class="va">observed_data</span> <span class="op">&lt;-</span> <span class="va">sim_output</span><span class="op">$</span><span class="fu">open_dataset</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">chunk_idx</span> <span class="op">==</span> <span class="fl">1</span>, <span class="va">condition_idx</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">target_sumstat</span> <span class="op">&lt;-</span> <span class="fu">summary_pipe</span><span class="op">(</span><span class="va">observed_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Prepare data for ABC fitting</span></span>
<span><span class="va">abc_input</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/build_abc_input.html">build_abc_input</a></span><span class="op">(</span></span>
<span>  simulation_output <span class="op">=</span> <span class="va">sim_output</span>,</span>
<span>  simulation_summary <span class="op">=</span> <span class="va">simulation_sumstat</span>,</span>
<span>  target_summary <span class="op">=</span> <span class="va">target_sumstat</span>,</span>
<span>  param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A_beta_0"</span>, <span class="st">"A_beta_1"</span>, <span class="st">"V_beta_0"</span>, <span class="st">"V_beta_1"</span>, <span class="st">"ndt"</span>, <span class="st">"sigma"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#####################</span></span>
<span><span class="co"># ABC model fitting #</span></span>
<span><span class="co">#####################</span></span>
<span><span class="va">abc_rejection_model</span> <span class="op">&lt;-</span> <span class="fu">abc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/abc/man/abc.html" class="external-link">abc</a></span><span class="op">(</span></span>
<span>  target <span class="op">=</span> <span class="va">abc_input</span><span class="op">$</span><span class="va">target</span>,</span>
<span>  param <span class="op">=</span> <span class="va">abc_input</span><span class="op">$</span><span class="va">param</span>,</span>
<span>  sumstat <span class="op">=</span> <span class="va">abc_input</span><span class="op">$</span><span class="va">sumstat</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"rejection"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">abc_loclinear_model</span> <span class="op">&lt;-</span> <span class="fu">abc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/abc/man/abc.html" class="external-link">abc</a></span><span class="op">(</span></span>
<span>  target <span class="op">=</span> <span class="va">abc_input</span><span class="op">$</span><span class="va">target</span>,</span>
<span>  param <span class="op">=</span> <span class="va">abc_input</span><span class="op">$</span><span class="va">param</span>,</span>
<span>  sumstat <span class="op">=</span> <span class="va">abc_input</span><span class="op">$</span><span class="va">sumstat</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"loclinear"</span>,</span>
<span>  transf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"log"</span>, <span class="st">"log"</span>, <span class="st">"log"</span>, <span class="st">"none"</span>, <span class="st">"log"</span>, <span class="st">"log"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">abc_neuralnet_model</span> <span class="op">&lt;-</span> <span class="fu">abc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/abc/man/abc.html" class="external-link">abc</a></span><span class="op">(</span></span>
<span>  target <span class="op">=</span> <span class="va">abc_input</span><span class="op">$</span><span class="va">target</span>,</span>
<span>  param <span class="op">=</span> <span class="va">abc_input</span><span class="op">$</span><span class="va">param</span>,</span>
<span>  sumstat <span class="op">=</span> <span class="va">abc_input</span><span class="op">$</span><span class="va">sumstat</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"neuralnet"</span>,</span>
<span>  sizenet <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  maxit <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fl">1e-2</span>,</span>
<span>  kernel <span class="op">=</span> <span class="st">"epanechnikov"</span>,</span>
<span>  transf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"log"</span>, <span class="st">"log"</span>, <span class="st">"log"</span>, <span class="st">"none"</span>, <span class="st">"log"</span>, <span class="st">"log"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">####################</span></span>
<span><span class="co"># cross validation #</span></span>
<span><span class="co">####################</span></span>
<span><span class="va">abc_neuralnet_cv</span> <span class="op">&lt;-</span> <span class="fu">abc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/abc/man/cv4abc.html" class="external-link">cv4abc</a></span><span class="op">(</span></span>
<span>  param <span class="op">=</span> <span class="va">abc_input</span><span class="op">$</span><span class="va">param</span>,</span>
<span>  sumstat <span class="op">=</span> <span class="va">abc_input</span><span class="op">$</span><span class="va">sumstat</span>,</span>
<span>  abc.out <span class="op">=</span> <span class="va">abc_neuralnet_model</span>,</span>
<span>  nval <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  tols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/plot_cv_recovery.html">plot_cv_recovery</a></span><span class="op">(</span></span>
<span>  <span class="va">abc_neuralnet_cv</span>,</span>
<span>  n_rows <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  n_cols <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  resid_tol <span class="op">=</span> <span class="fl">0.99</span>,</span>
<span>  interactive <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/plot_cv_pair_correlation.html">plot_cv_pair_correlation</a></span><span class="op">(</span></span>
<span>  <span class="va">abc_neuralnet_cv</span>,</span>
<span>  interactive <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/summarise_posterior_parameters.html">summarise_posterior_parameters</a></span><span class="op">(</span></span>
<span>  <span class="va">abc_rejection_model</span>,</span>
<span>  <span class="co"># custom summary functions</span></span>
<span>  ci_level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  p10 <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/plot_posterior_parameters.html">plot_posterior_parameters</a></span><span class="op">(</span></span>
<span>  <span class="va">abc_rejection_model</span>,</span>
<span>  <span class="va">abc_input</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">#################</span></span>
<span><span class="co"># re-sample ABC #</span></span>
<span><span class="co">#################</span></span>
<span><span class="va">abc_resample_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/abc_resample.html">abc_resample</a></span><span class="op">(</span></span>
<span>  <span class="va">abc_input</span><span class="op">$</span><span class="va">target</span>,</span>
<span>  <span class="va">abc_input</span><span class="op">$</span><span class="va">param</span>,</span>
<span>  <span class="va">abc_input</span><span class="op">$</span><span class="va">sumstat</span>,</span>
<span>  n_iterations <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  n_samples <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"rejection"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/plot_resample_medians.html">plot_resample_medians</a></span><span class="op">(</span><span class="va">abc_resample_result</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/summarise_resample_medians.html">summarise_resample_medians</a></span><span class="op">(</span><span class="va">abc_resample_result</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#############</span></span>
<span><span class="co"># posterior #</span></span>
<span><span class="co">#############</span></span>
<span><span class="va">posterior_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/abc_posterior_bootstrap.html">abc_posterior_bootstrap</a></span><span class="op">(</span></span>
<span>  <span class="va">abc_neuralnet_model</span>,</span>
<span>  n_samples <span class="op">=</span> <span class="fl">500</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># specify posterior simulation config</span></span>
<span><span class="co"># or you can re-create a new config from scratch with posterior_params</span></span>
<span><span class="va">post_sim_config</span> <span class="op">&lt;-</span> <span class="va">sim_config</span></span>
<span><span class="va">post_sim_config</span><span class="op">$</span><span class="va">prior_params</span> <span class="op">&lt;-</span> <span class="va">posterior_params</span></span>
<span><span class="va">post_sim_config</span><span class="op">$</span><span class="va">prior_formulas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">noise_coef</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># exclude drawn posteriors</span></span>
<span></span>
<span><span class="co"># (optional) specify a path to save posterior simulations result</span></span>
<span><span class="va">temp_output_path_post</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">temp_base_path</span>, <span class="st">"posterior_output"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">post_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/run_simulation.html">run_simulation</a></span><span class="op">(</span></span>
<span>  config <span class="op">=</span> <span class="va">sim_config</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="va">temp_output_path_post</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot the posterior rt and accuracy</span></span>
<span><span class="fu"><a href="reference/plot_rt.html">plot_rt</a></span><span class="op">(</span></span>
<span>  <span class="va">post_output</span>,</span>
<span>  <span class="va">observed_data</span>,</span>
<span>  facet_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"item_idx"</span><span class="op">)</span>,</span>
<span>  facet_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/plot_accuracy.html">plot_accuracy</a></span><span class="op">(</span></span>
<span>  <span class="va">post_output</span>,</span>
<span>  <span class="va">observed_data</span>,</span>
<span>  facet_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group"</span><span class="op">)</span>,</span>
<span>  facet_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=eam" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/y-guang/eam/" class="external-link">Browse source code</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing eam</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Guangyu Zhu <br><small class="roles"> Author </small> <a href="https://orcid.org/0009-0005-1571-1782" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Guang Yang <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0009-0005-7675-3249" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Guangyu Zhu, Guang Yang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
